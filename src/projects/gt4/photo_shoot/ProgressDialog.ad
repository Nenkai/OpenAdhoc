module PROJECT::ROOT
{
	static result = nil;
	static callback = nil;

	function open(context, str, clback)
	{
		ROOT.x = 160.0;
		ROOT.y = 120.0;
		message.text = str;
	
		if (clback == nil)
		{
			OK.visible = false;
		}
		else
		{
			OK.visible = true;
		}
	
		setProgress(0.0);
		context.pushPage(ROOT);
		callback = clback;
		result = nil;
		return;
	}
	
	function close(context)
	{
		context.closePage(ROOT);
	}
	
	function setProgress(p)
	{
		progress.w = progress_bg.w * p;
		progress.texcoord_right = p;
	}
}

module PROJECT::ROOT::OK
{
	function onActivate(context, event, item)
	{
		main::sound.play("cancel");
		result = true;
		close(context);
		callback(context);
		return EVENTRESULT_FILTER;
	}
}