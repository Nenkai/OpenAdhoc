module LaboModeProject::ReplaySlotDialog
{
	static result = nil;

	function open(context)
	{
		context.pushPage(ReplaySlotDialog);
		result = nil;
		context.getUpdateContext().enterEventLoop();
		return result;
	}
	
	function close(context)
	{
		ReplaySlotDialog.setFocus(nil);
		context.closePage(ReplaySlotDialog);
		context.getUpdateContext().leaveEventLoop();
	}
	
	function reflect(context)
	{
		var option = main::game.option;
		Pane::McSlot::OptionMenu.setIndex(context, option.replay_memory_card_slot);
	}
	
	function apply()
	{
		var option = main::game.option;
		option.replay_memory_card_slot = Pane::McSlot::OptionMenu.index;
	}

	function onInitialize(context)
	{
		Pane::McSlot::label.adjustScale();
		ReplaySlotDialog.setFocus(Pane::McSlot::OptionMenu);
		reflect(context);
	}
	
	function onFinalize(context)
	{
	}
	
	function onCancel(context)
	{
		main::sound.play("cancel");
		result = false;
		close(context);
		return EVENTRESULT_FILTER;
	}
}

module LaboModeProject::ReplaySlotDialog::Pane::Buttons::Cancel
{
	function onActivate(context)
	{
		main::sound.play("ok");
		close(context);
		return EVENTRESULT_FILTER;
	}
}

module LaboModeProject::ReplaySlotDialog::Pane::Buttons::OK
{
	function onActivate(context)
	{
		main::sound.play("ok");
		apply();
		close(context);
		return EVENTRESULT_FILTER;
	}
}